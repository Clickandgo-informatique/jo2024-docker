@startuml
title Filtrage dynamique des sports - AJAX + QueryString (Symfony 7.3)

actor Utilisateur as U
participant "Interface Web\n(Twig + JavaScript)" as FE
participant "ContrÃ´leur Symfony\n(SportController)" as BE
database "Base de donnÃ©es\nMySQL" as DB

== Choix dâ€™un filtre ==
U -> FE : SÃ©lection dâ€™un filtre exclusif\n(sport / catÃ©gorie / favoris)
FE -> FE : RÃ©initialise les autres filtres
FE -> FE : Construit lâ€™URL avec querystring\nex: /api/sports?categorie=olympiques

== RequÃªte AJAX ==
FE -> BE : XMLHttpRequest GET /api/sports?categorie=olympiques
activate BE

BE -> DB : SELECT * FROM sport\nWHERE type = 'olympiques'
DB --> BE : RÃ©sultats JSON (liste des sports filtrÃ©s)
BE --> FE : JsonResponse { sports: [...] }
deactivate BE

== Mise Ã  jour du DOM ==
FE -> FE : Met Ã  jour la liste affichÃ©e (innerHTML)
FE -> FE : Supprime les anciens rÃ©sultats
FE --> U : Affiche les sports filtrÃ©s instantanÃ©ment\n(sans rechargement de page)

== Cas particulier : Favoris ==
U -> FE : Clic sur "Favoris"
FE -> BE : XMLHttpRequest GET /api/sports?favoris=1
BE -> DB : SELECT * FROM sport WHERE favoris = true
DB --> BE : RÃ©sultats filtrÃ©s
BE --> FE : JsonResponse { favoris: [...] }
FE --> U : Liste mise Ã  jour (favoris uniquement)

note right of FE
  âš™ï¸ RequÃªtes AJAX typiques :
  - /api/sports?sport=natation
  - /api/sports?categorie=paralympiques
  - /api/sports?favoris=1

  ğŸ’¬ RÃ©ponse JSON :
  {
    "sports": [
      {"id":1, "sport":"Natation", "emoji":"ğŸŠâ€â™‚ï¸"},
      {"id":2, "sport":"PlongÃ©e", "emoji":"ğŸ¤¿"}
    ]
  }
end note

@enduml
