{# 
    Template d'affichage d'un ticket dans le navigateur
    Variables disponibles :
    - ticket : l'entit√© Ticket
    - commande : l'entit√© Commande associ√©e
    - qrCodeBase64 : QR code SVG/PNG encod√© en base64 pour affichage
#}

{% extends 'base.html.twig' %}

{% block title %}
	Ticket - Commande
	{{ ticket.commande.reference }}
{% endblock %}

{% block body %}
	<div class="container mt-5" style="font-family:Verdana, sans-serif;">
		<a href="{{ path('app_commandes_liste') }}" class="btn btn-primary mb-3">
			<i class="fa-solid fa-list"></i>
			Retour √† mes commandes
		</a>

		<h1>Votre ticket</h1>
		<p>Gardez soigneusement ce ticket, il vous sera demand√© √† la caisse.</p>

		<div class="card p-3 mb-3" style="max-width: 400px; margin:auto; border:1px solid #ccc;">
			<p>
				<strong>Commande :</strong>
				{{ ticket.commande.reference }}</p>
			<p>
				<strong>Pay√©e le :</strong>
				{{ ticket.commande.payeeLe|date('d/m/Y H:i') }}</p>

			{# üîπ Affiche le QR code si disponible #}
			{% if qrCodeBase64 %}
				<div class="text-center my-3">
					<img src="{{ qrCodeBase64 }}" alt="QR Code du ticket" style="width:200px; height:200px;">
				</div>
			{% else %}
				<p class="text-danger">QR code non disponible.</p>
			{% endif %}

			<p>
				<strong>Cl√© du ticket :</strong>
				{{ ticket.ticketKey }}</p>
			<p>
				<strong>Hash :</strong>
				{{ ticket.payloadHash }}</p>
		</div>

		{# üîπ Lien vers la g√©n√©ration PDF #}
		<div class="text-center mt-3">
			<a href="{{ path('app_ticket_pdf', {'ticketKey': ticket.ticketKey}) }}" class="btn btn-primary">

				<i class="fa-solid fa-file-pdf"></i>
				Voir / imprimer PDF
			</a>
		</div>
	</div>
{% endblock %}
